<project name="LL_layout" default="build">
  <!-- Generated by MPS -->
  <property name="build.dir" location="build" />
  <property name="build.tmp" location="${build.dir}/tmp/LL_layout" />
  <property name="build.layout" location="${build.dir}/artifacts/LL_layout" />
  <property name="mps_home" location="${basedir}/MPS_zip_unpacked/MPS 2018.2 EAP" />
  <property name="build.number" value="LanguageLabMPS-182.SNAPSHOT" />
  <tstamp>
    <format property="date" pattern="yyyyMMdd" />
  </tstamp>
  <property name="artifacts.mps" location="${mps_home}" />
  <property name="artifacts.LL_bootstrap" location="${build.dir}/artifacts/LL_bootstrap" />
  <property file="${artifacts.mps}/build.properties" prefix="import.mps" />
  <property file="${artifacts.LL_bootstrap}/build.properties" prefix="import.LL_bootstrap" />
  <property name="mps.build.number" value="${import.mps.mps.build.number}" />
  <property name="mps.date" value="${import.mps.mps.date}" />
  <property name="mps.build.vcs.number" value="${import.mps.mps.build.vcs.number}" />
  <property name="mps.teamcity.buildConfName" value="${import.mps.mps.teamcity.buildConfName}" />
  <property name="mps.idea.platform.build.number" value="${import.mps.mps.idea.platform.build.number}" />
  <property name="mps.mps.build.counter" value="${import.mps.mps.mps.build.counter}" />
  <property name="mpsBootstrapCore.version" value="${import.mps.mpsBootstrapCore.version}" />
  <property name="LL_bootstrap.build.number" value="${import.LL_bootstrap.LL_bootstrap.build.number}" />
  
  <target name="assemble" depends="classes, declare-mps-tasks, fetchDependencies">
    <mkdir dir="${build.layout}" />
    <copy todir="${build.layout}">
      <fileset dir="${artifacts.mps}">
        <exclude name="lib/branding.jar" />
        <exclude name="build.number" />
        <exclude name="lib/MPS-src.zip" />
        <exclude name="bin/**/*.*" />
      </fileset>
    </copy>
    <mkdir dir="${build.layout}/bin" />
    <copy todir="${build.layout}/bin">
      <fileset dir="${artifacts.mps}/bin">
        <include name="log.xml" />
        <include name="log4j.dtd" />
      </fileset>
    </copy>
    <copy todir="${build.layout}/bin">
      <fileset file="${mps_home}/bin/idea.properties" />
      <filterchain>
        <tokenfilter>
          <replaceregex pattern="\.MPS(\w+)" replace="\.${build.number}" flags="g" />
        </tokenfilter>
      </filterchain>
    </copy>
    <mkdir dir="${build.layout}/lib" />
    <mkdir dir="${build.tmp}/default/branding.jar" />
    <mkdir dir="${build.tmp}/default/branding.jar/idea" />
    <echoxml file="${build.tmp}/default/branding.jar/idea/IdeaApplicationInfo.xml">
      <component>
        <version codename="LanguageLab@MPS" major="1" minor="0" eap="false" />
        <company name="University of Agder" url="https://www.uia.no/" copyrightStart="2012" />
        <build number="${build.number}" date="${date}" />
        <logo url="/splash.png" textcolor="FFFFFF" progressColor="FFFFFF" progressX="100" progressY="280" progressHeight="10" />
        <about url="/about.png" foreground="FFFFFF" copyrightForeground="FFFFFF" />
        <icon size32="/MPS32.png" size16="/MPS16.png" />
        <package code="code" />
        <names product="LanguageLabMPS" fullname="LanguageLabMPS" script="languagelabmps" />
        
        <welcome-screen logo-url="/logo.png" />
        
        
        <plugins url="" />
        
        
      </component>
    </echoxml>
    <jar destfile="${build.layout}/lib/branding.jar" duplicate="preserve">
      <fileset file="${basedir}/icons/MPS16.png" />
      <fileset file="${basedir}/icons/MPS32.png" />
      <fileset file="${basedir}/icons/logo.png" />
      <fileset file="${basedir}/icons/splash.png" />
      <fileset file="${basedir}/icons/about.png" />
      <fileset dir="${build.tmp}/default/branding.jar" />
    </jar>
    <mkdir dir="${build.layout}/plugins" />
    <mkdir dir="${build.layout}/plugins/LanguageLab" />
    <copy todir="${build.layout}/plugins/LanguageLab">
      <fileset dir="${build.tmp}/deps/LL_bootstrap/_dl__lbrace_build.number_rbrace_-plugin.zip/LanguageLab" />
    </copy>
    <echo file="${build.layout}/build.number">build.number=${build.number}${line.separator}date=${date}${line.separator}version=1.0</echo>
    <echo file="${build.layout}/build.properties">LL_layout.build.number=${build.number}${line.separator}LL_layout.date=${date}${line.separator}mps.build.number=${mps.build.number}${line.separator}mps.date=${mps.date}${line.separator}mps.build.vcs.number=${mps.build.vcs.number}${line.separator}mps.teamcity.buildConfName=${mps.teamcity.buildConfName}${line.separator}mps.idea.platform.build.number=${mps.idea.platform.build.number}${line.separator}mps.mps.build.counter=${mps.mps.build.counter}${line.separator}mpsBootstrapCore.version=${mpsBootstrapCore.version}${line.separator}LL_bootstrap.build.number=${LL_bootstrap.build.number}</echo>
  </target>
  
  <target name="buildDependents">
    <ant antfile="build_ll.xml" inheritAll="false" useNativeBasedir="true" />
  </target>
  
  <target name="fetchDependencies">
    <mkdir dir="${build.tmp}/deps/LL_bootstrap/_dl__lbrace_build.number_rbrace_-plugin.zip" />
    <unzip src="${artifacts.LL_bootstrap}/${LL_bootstrap.build.number}-plugin.zip" dest="${build.tmp}/deps/LL_bootstrap/_dl__lbrace_build.number_rbrace_-plugin.zip" />
  </target>
  
  <target name="build" depends="assemble" />
  
  <target name="clean">
    <delete dir="${build.tmp}" />
    <delete dir="${build.layout}" />
  </target>
  
  <target name="compileJava" />
  
  <target name="processResources" />
  
  <target name="classes" depends="compileJava, processResources" />
  
  <target name="test" depends="classes" />
  
  <target name="check" depends="test" />
  
  <target name="generate" depends="declare-mps-tasks" />
  
  <target name="declare-mps-tasks" />
  
  <target name="makeDependents" />
</project>